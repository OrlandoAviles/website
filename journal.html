<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Morning Pages — Word Counter</title>
  <style>
    :root {
      --bg: #0f1115;
      --panel: #171a21;
      --ink: #e7e9ee;
      --muted: #9aa3b2;
      --accent: #4aa3ff;
      --accent-2: #6cffb3;
      --danger: #ff6b6b;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: radial-gradient(1200px 800px at 20% -10%, #1a1f2b 0%, var(--bg) 60%) fixed;
      color: var(--ink);
      font: 16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif;
    }
    .wrap {
      max-width: 900px;
      margin: 0 auto;
      padding: 16px clamp(12px, 4vw, 24px) 24px;
      display: grid;
      gap: 14px;
    }
    header {
      position: sticky;
      top: 0;
      background: color-mix(in srgb, var(--bg) 80%, transparent);
      backdrop-filter: blur(8px);
      border-bottom: 1px solid color-mix(in srgb, var(--ink) 12%, transparent);
      z-index: 5;
      padding: 12px 0 10px;
    }
    h1 {
      margin: 0 0 6px;
      font-size: clamp(18px, 2.6vw, 24px);
      font-weight: 700;
      letter-spacing: 0.2px;
    }
    .counts {
      display: flex;
      gap: 10px;
      align-items: center;
      color: var(--muted);
      font-size: 14px;
    }
    .counts strong { color: var(--ink); }

    .meter {
      height: 9px;
      background: #0b0d11;
      border: 1px solid #1f2430;
      border-radius: 999px;
      overflow: hidden;
    }
    .bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      transition: width 120ms linear;
    }

    textarea {
      width: 100%;
      min-height: 55vh;
      resize: vertical;
      padding: clamp(14px, 3.2vw, 18px);
      background: var(--panel);
      border: 1px solid #232937;
      border-radius: 14px;
      color: var(--ink);
      caret-color: var(--accent);
      outline: none;
      font: 17px/1.7 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      letter-spacing: 0.2px;
    }
    textarea::placeholder { color: #7d8796; }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 12px 16px;
      align-items: center;
      justify-content: space-between;
    }
    .left, .right { display: flex; gap: 12px; align-items: center; }

    button, label.btn-like {
      appearance: none;
      border: 1px solid #2a3040;
      background: #151925;
      color: var(--ink);
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      transition: transform 60ms ease, background 120ms ease, border-color 120ms ease;
      user-select: none;
    }
    button:active { transform: translateY(1px); }
    button:hover { background: #1a1f2b; border-color: #364056; }

    .muted { color: var(--muted); font-weight: 500; }
    .danger { color: var(--danger); }

    .sr-only {
      position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Morning Pages</h1>
      <div class="counts" aria-live="polite">
        <div>
          <strong id="wordCount">0</strong> / <span id="target">1000</span> words
        </div>
        <div class="muted">(<span id="remaining">1000</span> to go)</div>
      </div>
      <div class="meter" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" aria-label="Progress to 1000 words">
        <div class="bar" id="bar"></div>
      </div>
    </header>

    <textarea id="paper" spellcheck="false" placeholder="Type your morning pages here. Stream of consciousness. No one’s judging except that little voice in your head, which we are ignoring today."></textarea>

    <div class="controls">
      <div class="left">
        <button id="resetBtn" title="Clear everything">Reset</button>
        <label class="btn-like" title="Toggle the congratulatory alert when you hit 1000 words">
          <input id="toggleAlert" type="checkbox" checked class="sr-only" />
          Alert at 1000
        </label>
      </div>
      <div class="right muted">
        <span id="chars">0</span> characters
      </div>
    </div>
  </div>

  <script>
    // Target words
    const TARGET = 1000;

    // Elements
    const paper = document.getElementById('paper');
    const wordCountEl = document.getElementById('wordCount');
    const remainingEl = document.getElementById('remaining');
    const targetEl = document.getElementById('target');
    const charsEl = document.getElementById('chars');
    const bar = document.getElementById('bar');
    const toggleAlert = document.getElementById('toggleAlert');
    const resetBtn = document.getElementById('resetBtn');

    targetEl.textContent = TARGET;

    let lastCount = 0;

    // Unicode-aware word matcher: sequences of letters/numbers with apostrophes accepted
    function countWords(text) {
      const tokens = text.trim().match(/[\p{L}\p{N}’']+/gu);
      return tokens ? tokens.length : 0;
    }

    function update() {
      const text = paper.value;
      const words = countWords(text);
      const chars = text.length;

      wordCountEl.textContent = words;
      charsEl.textContent = chars.toLocaleString();
      remainingEl.textContent = Math.max(0, TARGET - words);

      const pct = Math.min(100, Math.round((words / TARGET) * 100));
      bar.style.width = pct + '%';
      bar.parentElement.setAttribute('aria-valuenow', String(pct));

      // Fire a one-time alert when crossing the threshold upward
      if (toggleAlert.checked && lastCount < TARGET && words >= TARGET) {
        // Delay a tick so mobile keyboards don't swallow the alert
        setTimeout(() => {
          alert('You hit 1000 words. Gold star. Hydrate and carry on.');
        }, 50);
      }

      lastCount = words;
      document.title = `${words} / ${TARGET} — Morning Pages`;
    }

    // Events
    paper.addEventListener('input', update);
    paper.addEventListener('change', update);

    resetBtn.addEventListener('click', () => {
      if (!paper.value || confirm('Clear all text?')) {
        paper.value = '';
        lastCount = 0;
        update();
        paper.focus();
      }
    });

    // Initial paint
    update();

    // Place cursor at end if browser restores value on refresh
    window.addEventListener('load', () => {
      const len = paper.value.length;
      paper.setSelectionRange(len, len);
    });
  </script>
</body>
</html>
