<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ATB Combat Prototype – 3v1</title>

<style>
/* ===== GLOBAL ===== */
html, body {
    margin: 0;
    padding: 0;
    background: radial-gradient(circle at top, #0b0f1a, #000);
    color: #e6ecff;
    font-family: system-ui, -apple-system, Segoe UI, sans-serif;
}

body {
    display: flex;
    flex-direction: column;
    align-items: center;
}

/* ===== GAME CONTAINER ===== */
#game {
    max-width: 480px;
    width: 100%;
    padding: 12px;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    gap: 14px;
}

/* ===== UNIT CARDS ===== */
.unit {
    background: linear-gradient(180deg, #0f1628, #070a14);
    border-radius: 10px;
    padding: 10px;
    box-shadow:
        inset 0 0 0 1px rgba(120,160,255,0.15),
        0 8px 24px rgba(0,0,0,0.6);
}

/* ===== LABELS ===== */
.label {
    font-size: 12px;
    letter-spacing: 0.5px;
    color: #9fb4ff;
    margin-bottom: 3px;
}

/* ===== BARS ===== */
.bar {
    height: 10px;
    background: #1a1f33;
    border-radius: 999px;
    overflow: hidden;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.8);
    margin-bottom: 6px;
}

.bar > div {
    height: 100%;
    width: 0%;
    border-radius: 999px;
    transition: width 0.25s linear;
}

/* HP */
.bar > div {
    background: linear-gradient(
        90deg,
        #2cff6a,
        #6dff9c
    );
    box-shadow: 0 0 6px rgba(60,255,140,0.7);
}

/* ATB */
.atb > div {
    background: linear-gradient(
        90deg,
        #3aa0ff,
        #7fd1ff
    );
    box-shadow: 0 0 6px rgba(80,160,255,0.8);
}

/* ===== ROLE BUTTONS ===== */
.buttons {
    display: flex;
    gap: 6px;
    margin-top: 6px;
}

button {
    flex: 1;
    padding: 6px 0;
    font-size: 11px;
    letter-spacing: 0.4px;
    text-transform: uppercase;
    background: linear-gradient(180deg, #141c33, #0b1020);
    color: #cfe0ff;
    border: none;
    border-radius: 6px;
    box-shadow:
        inset 0 0 0 1px rgba(120,160,255,0.2),
        0 2px 6px rgba(0,0,0,0.6);
    cursor: pointer;
}

button:hover {
    background: linear-gradient(180deg, #1b2550, #0f1633);
}

/* Enemy emphasis */
.unit.enemy {
    border: 1px solid rgba(255,120,120,0.25);
}

.unit.enemy .bar > div {
    background: linear-gradient(90deg, #ff4a4a, #ff9a9a);
    box-shadow: 0 0 8px rgba(255,80,80,0.9);
}


/* ===== LOG ===== */
#log {
    background: linear-gradient(180deg, #060912, #02040a);
    border-radius: 10px;
    padding: 10px;
    box-shadow:
        inset 0 0 0 1px rgba(120,160,255,0.15),
        0 8px 24px rgba(0,0,0,0.6);
    max-height: 160px;
    overflow-y: auto;
    font-size: 13px;
}

#log div {
    color: #9aa4cc;
}

#log div:last-child {
    color: #ffffff;
}

</style>
</head>

<body>

<div id="game">

    <!-- Enemy -->
    <div class="unit enemy">
        <div class="label">Enemy HP</div>
        <div class="bar"><div id="enemy-hp"></div></div>
        <div class="label">Enemy ATB</div>
        <div class="bar atb"><div id="enemy-atb"></div></div>
    </div>

    <!-- Players -->
    <div id="players"></div>

    <div id="log"></div>
</div>

<script>
const log = document.getElementById("log");

const players = [
    { hp: 100, maxHp: 100, atb: 0, role: "Commando", atbRate: 1.0 },
    { hp: 100, maxHp: 100, atb: 0, role: "Ravager",  atbRate: 1.2 },
    { hp: 100, maxHp: 100, atb: 0, role: "Medic",   atbRate: 1.4 }
];

const enemy = {
    hp: 600,
    maxHp: 600,
    atb: 0
};

const speed = 1.6;

function logMsg(msg) {
    const div = document.createElement("div");
    div.textContent = msg;
    log.appendChild(div);
    log.scrollTop = log.scrollHeight;
}

function renderPlayers() {
    const container = document.getElementById("players");
    container.innerHTML = "";

    players.forEach((p, i) => {
        const unit = document.createElement("div");
        unit.className = "unit";

        unit.innerHTML = `
            <div class="label">Player ${i + 1} HP</div>
            <div class="bar"><div id="p${i}-hp"></div></div>
            <div class="label">ATB</div>
            <div class="bar atb"><div id="p${i}-atb"></div></div>
            <div class="buttons">
                <button onclick="setRole(${i}, 'Commando')">Com</button>
                <button onclick="setRole(${i}, 'Ravager')">Rav</button>
                <button onclick="setRole(${i}, 'Medic')">Med</button>
            </div>
        `;
        container.appendChild(unit);
    });
}

function setRole(i, role) {
    players[i].role = role;
    logMsg(`Player ${i + 1} → ${role}`);
}

function updateBars() {
    players.forEach((p, i) => {
        document.getElementById(`p${i}-hp`).style.width =
            (p.hp / p.maxHp * 100) + "%";
        document.getElementById(`p${i}-atb`).style.width =
            Math.min(p.atb, 100) + "%";
    });

    document.getElementById("enemy-hp").style.width =
        (enemy.hp / enemy.maxHp * 100) + "%";
    document.getElementById("enemy-atb").style.width =
        Math.min(enemy.atb, 100) + "%";
}

function alivePlayers() {
    return players.filter(p => p.hp > 0);
}

function gameLoop() {
    players.forEach((p, i) => {
        if (p.hp <= 0) return;

        p.atb += p.atbRate * speed;
        if (p.atb >= 100) {
            if (p.role === "Commando") {
                enemy.hp = Math.max(0, enemy.hp - 25);
                logMsg(`P${i + 1} attacks (25)`);
            }
            if (p.role === "Ravager") {
                enemy.hp = Math.max(0, enemy.hp - 15);
                logMsg(`P${i + 1} rapid hits (15)`);
            }
            if (p.role === "Medic") {
                p.hp = Math.min(p.maxHp, p.hp + 30);
                logMsg(`P${i + 1} heals (30)`);
            }
            p.atb = 0;
        }
    });

    enemy.atb += 2 * speed;
    if (enemy.atb >= 100) {
        const targets = alivePlayers();
        if (targets.length > 0) {
            const t = targets[Math.floor(Math.random() * targets.length)];
            t.hp = Math.max(0, t.hp - 20);
            logMsg("Enemy attacks (20)");
        }
        enemy.atb = 0;
    }

    updateBars();

    if (enemy.hp > 0 && alivePlayers().length > 0) {
        setTimeout(gameLoop, 100);
    } else {
        logMsg(enemy.hp <= 0 ? "Victory!" : "Defeat...");
    }
}

renderPlayers();
updateBars();
gameLoop();
</script>

</body>
</html>
